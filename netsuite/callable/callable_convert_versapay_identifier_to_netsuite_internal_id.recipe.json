{
  "name": "Callable - Convert VersaPay Identifier to NetSuite Internal ID",
  "description": "When there is a trigger event, do action",
  "version": 1,
  "private": true,
  "concurrency": 5,
  "code": {
    "number": 0,
    "provider": "workato_service",
    "name": "receive_request",
    "as": "f45c6aa0",
    "title": null,
    "description": "New <span class=\"provider\">call</span> for <span class=\"provider\">Convert VersaPay Identifier to NetSuite Internal ID</span>",
    "keyword": "trigger",
    "dynamicPickListSelection": {
    },
    "toggleCfg": {
    },
    "input": {
      "service_name": "Convert VersaPay Identifier to NetSuite Internal ID",
      "request_schema_json": "[{\"control_type\":\"text\",\"label\":\"VersaPay Identifier\",\"name\":\"versapay_identifier\",\"type\":\"string\",\"optional\":false}]",
      "reply_schema_json": "[{\"control_type\":\"text\",\"label\":\"NetSuite Internal ID\",\"name\":\"netsuite_internal_id\",\"type\":\"string\",\"optional\":false},{\"control_type\":\"text\",\"label\":\"Type\",\"name\":\"type\",\"type\":\"string\",\"optional\":false}]"
    },
    "extended_output_schema": [
      {
        "type": "object",
        "name": "request",
        "label": "Recipe input",
        "properties": [
          {
            "control_type": "text",
            "label": "VersaPay Identifier",
            "name": "versapay_identifier",
            "type": "string",
            "optional": false
          }
        ]
      }
    ],
    "block": [
      {
        "number": 1,
        "provider": "workato_variable",
        "name": "declare_variable",
        "as": "7d557d3e",
        "title": "Create variable versapay_identifier",
        "description": "Create variable <span class=\"provider\">versapay_identifier</span>",
        "keyword": "action",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "string",
          "name": "versapay_identifier",
          "value": "#{_('data.workato_service.f45c6aa0.request.versapay_identifier')}"
        },
        "extended_output_schema": [
          {
            "type": "string",
            "name": "value",
            "control_type": "text",
            "label": "versapay_identifier"
          }
        ],
        "extended_input_schema": [
          {
            "type": "string",
            "name": "value",
            "control_type": "text",
            "label": "Default value",
            "hint": "Default value for the variable",
            "sticky": true,
            "optional": true,
            "strip_interpolation": true
          }
        ],
        "uuid": "acbfe474-205c-4953-9c8c-3d857b0651fa"
      },
      {
        "number": 2,
        "keyword": "if",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "compound",
          "operand": "and",
          "conditions": [
            {
              "operand": "contains",
              "lhs": "#{_('data.workato_variable.7d557d3e.value')}",
              "rhs": "|"
            }
          ]
        },
        "block": [
          {
            "number": 3,
            "provider": "workato_variable",
            "name": "update_variable",
            "as": "4d3e36b3",
            "title": "Update variable versapay_identifier",
            "description": "Update variable <span class=\"provider\">versapay_identifier</span>",
            "keyword": "action",
            "dynamicPickListSelection": {
              "name": "versapay_identifier (step 1)"
            },
            "toggleCfg": {
            },
            "input": {
              "name": "acbfe474-205c-4953-9c8c-3d857b0651fa:7d557d3e",
              "value": "=_('data.workato_variable.7d557d3e.value').gsub(/^(.*)\\|/,\"\")"
            },
            "extended_input_schema": [
              {
                "type": "string",
                "name": "value",
                "control_type": "text",
                "label": "Value",
                "hint": "Provide value for the variable",
                "strip_interpolation": true
              }
            ],
            "comment": "The regex matches everything up to and including the | and replaces it with an empty string",
            "uuid": "97b5282e-86d5-402e-bdfd-ae3505bfe01d"
          }
        ],
        "comment": "Sometimes VersaPay will include the organization identifier to the identifier, for example an invoice could have an identifier of \"rapid7demo|invo-9072809\".Â  In this case we need to strip off the organization identifier.",
        "uuid": "b4790216-d6ec-4fb3-94dc-37bbc74e963e"
      },
      {
        "number": 4,
        "provider": "workato_variable",
        "name": "declare_variable",
        "as": "aa212a0e",
        "title": "Create variable versapay_type",
        "description": "Create variable <span class=\"provider\">versapay_type</span>",
        "keyword": "action",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "string",
          "name": "versapay_type",
          "value": "=_('data.workato_variable.7d557d3e.value').split(\"-\")[0]"
        },
        "extended_output_schema": [
          {
            "type": "string",
            "name": "value",
            "control_type": "text",
            "label": "versapay_type"
          }
        ],
        "extended_input_schema": [
          {
            "type": "string",
            "name": "value",
            "control_type": "text",
            "label": "Default value",
            "hint": "Default value for the variable",
            "sticky": true,
            "optional": true,
            "strip_interpolation": true
          }
        ],
        "uuid": "44fb0fc2-af79-401e-a257-d33e81f89105"
      },
      {
        "number": 5,
        "provider": "workato_variable",
        "name": "declare_variable",
        "as": "3a4377cd",
        "title": "Create variable internal_id",
        "description": "Create variable <span class=\"provider\">internal_id</span>",
        "keyword": "action",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "string",
          "name": "internal_id",
          "value": "=_('data.workato_variable.7d557d3e.value').split(\"-\")[1]"
        },
        "extended_output_schema": [
          {
            "type": "string",
            "name": "value",
            "control_type": "text",
            "label": "internal_id"
          }
        ],
        "extended_input_schema": [
          {
            "type": "string",
            "name": "value",
            "control_type": "text",
            "label": "Default value",
            "hint": "Default value for the variable",
            "sticky": true,
            "optional": true,
            "strip_interpolation": true
          }
        ],
        "uuid": "b8cdd98d-57eb-406b-a884-013ae6ae9236"
      },
      {
        "number": 6,
        "provider": "workato_variable",
        "name": "declare_variable",
        "as": "7a1d0a8b",
        "title": "Create variable type",
        "description": "Create variable <span class=\"provider\">type</span>",
        "keyword": "action",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "string",
          "name": "type",
          "value": "unknown"
        },
        "extended_output_schema": [
          {
            "type": "string",
            "name": "value",
            "control_type": "text",
            "label": "type"
          }
        ],
        "extended_input_schema": [
          {
            "type": "string",
            "name": "value",
            "control_type": "text",
            "label": "Default value",
            "hint": "Default value for the variable",
            "sticky": true,
            "optional": true,
            "strip_interpolation": true
          }
        ],
        "uuid": "f9ae23e2-5b7b-4b0e-b0f7-f54cbc5dd938"
      },
      {
        "number": 7,
        "keyword": "if",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "compound",
          "operand": "and",
          "conditions": [
            {
              "operand": "equals_to",
              "lhs": "#{_('data.workato_variable.aa212a0e.value')}",
              "rhs": "con"
            }
          ]
        },
        "block": [
          {
            "number": 8,
            "provider": "workato_variable",
            "name": "update_variable",
            "as": "3bb3f0f3",
            "title": "Update variable type",
            "description": "Update variable <span class=\"provider\">type</span>",
            "keyword": "action",
            "dynamicPickListSelection": {
              "name": "type (step 2)"
            },
            "toggleCfg": {
            },
            "input": {
              "name": "f9ae23e2-5b7b-4b0e-b0f7-f54cbc5dd938:7a1d0a8b",
              "value": "Contact"
            },
            "extended_input_schema": [
              {
                "type": "string",
                "name": "value",
                "control_type": "text",
                "label": "Value",
                "hint": "Provide value for the variable",
                "strip_interpolation": true
              }
            ],
            "uuid": "209c384d-b26d-4f6b-95ce-3807e9a784a9"
          }
        ],
        "uuid": "370f5125-de75-4862-bfbe-488efbdf5a5d"
      },
      {
        "number": 9,
        "keyword": "if",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "compound",
          "operand": "and",
          "conditions": [
            {
              "operand": "equals_to",
              "lhs": "#{_('data.workato_variable.aa212a0e.value')}",
              "rhs": "cmmo"
            }
          ]
        },
        "block": [
          {
            "number": 10,
            "provider": "workato_variable",
            "name": "update_variable",
            "as": "4b7b1c68",
            "title": "Update variable type",
            "description": "Update variable <span class=\"provider\">type</span>",
            "keyword": "action",
            "dynamicPickListSelection": {
              "name": "type (step 2)"
            },
            "toggleCfg": {
            },
            "input": {
              "name": "f9ae23e2-5b7b-4b0e-b0f7-f54cbc5dd938:7a1d0a8b",
              "value": "Credit Memo"
            },
            "extended_input_schema": [
              {
                "type": "string",
                "name": "value",
                "control_type": "text",
                "label": "Value",
                "hint": "Provide value for the variable",
                "strip_interpolation": true
              }
            ],
            "uuid": "b1c334bd-6bb6-431e-be2c-a31ebc629c12"
          }
        ],
        "uuid": "b61bc471-4e0f-4277-b52b-7039876a3cd7"
      },
      {
        "number": 11,
        "keyword": "if",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "compound",
          "operand": "and",
          "conditions": [
            {
              "operand": "equals_to",
              "lhs": "#{_('data.workato_variable.aa212a0e.value')}",
              "rhs": "cmapp"
            }
          ]
        },
        "block": [
          {
            "number": 12,
            "provider": "workato_variable",
            "name": "update_variable",
            "as": "270e1c04",
            "title": "Update variable type",
            "description": "Update variable <span class=\"provider\">type</span>",
            "keyword": "action",
            "dynamicPickListSelection": {
              "name": "type (step 2)"
            },
            "toggleCfg": {
            },
            "input": {
              "name": "f9ae23e2-5b7b-4b0e-b0f7-f54cbc5dd938:7a1d0a8b",
              "value": "Credit Memo Application"
            },
            "extended_input_schema": [
              {
                "type": "string",
                "name": "value",
                "control_type": "text",
                "label": "Value",
                "hint": "Provide value for the variable",
                "strip_interpolation": true
              }
            ],
            "uuid": "c9944ed2-acb3-4673-beee-8b759abb7dfc"
          }
        ],
        "uuid": "594a22ed-eae6-4924-aefd-742c66c81a37"
      },
      {
        "number": 13,
        "keyword": "if",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "compound",
          "operand": "and",
          "conditions": [
            {
              "operand": "equals_to",
              "lhs": "#{_('data.workato_variable.aa212a0e.value')}",
              "rhs": "cmpmt"
            }
          ]
        },
        "block": [
          {
            "number": 14,
            "provider": "workato_variable",
            "name": "update_variable",
            "as": "0bb50ddf",
            "title": "Update variable type",
            "description": "Update variable <span class=\"provider\">type</span>",
            "keyword": "action",
            "dynamicPickListSelection": {
              "name": "type (step 2)"
            },
            "toggleCfg": {
            },
            "input": {
              "name": "f9ae23e2-5b7b-4b0e-b0f7-f54cbc5dd938:7a1d0a8b",
              "value": "Credit Memo Payment"
            },
            "extended_input_schema": [
              {
                "type": "string",
                "name": "value",
                "control_type": "text",
                "label": "Value",
                "hint": "Provide value for the variable",
                "strip_interpolation": true
              }
            ],
            "uuid": "6eaa5fc7-dfac-46e7-88ec-99342e268490"
          }
        ],
        "uuid": "cc1a0fbf-91d8-44d0-90f6-c695ee86edd2"
      },
      {
        "number": 15,
        "keyword": "if",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "compound",
          "operand": "and",
          "conditions": [
            {
              "operand": "equals_to",
              "lhs": "#{_('data.workato_variable.aa212a0e.value')}",
              "rhs": "cust"
            }
          ]
        },
        "block": [
          {
            "number": 16,
            "provider": "workato_variable",
            "name": "update_variable",
            "as": "c81388cb",
            "title": "Update variable type",
            "description": "Update variable <span class=\"provider\">type</span>",
            "keyword": "action",
            "dynamicPickListSelection": {
              "name": "type (step 2)"
            },
            "toggleCfg": {
            },
            "input": {
              "name": "f9ae23e2-5b7b-4b0e-b0f7-f54cbc5dd938:7a1d0a8b",
              "value": "Customer"
            },
            "extended_input_schema": [
              {
                "type": "string",
                "name": "value",
                "control_type": "text",
                "label": "Value",
                "hint": "Provide value for the variable",
                "strip_interpolation": true
              }
            ],
            "uuid": "86da3756-a9e3-42bf-8579-20bb0e9d02c8"
          }
        ],
        "uuid": "e9e5bbd1-3119-4191-905c-b2f75d0c561e"
      },
      {
        "number": 17,
        "keyword": "if",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "compound",
          "operand": "and",
          "conditions": [
            {
              "operand": "equals_to",
              "lhs": "#{_('data.workato_variable.aa212a0e.value')}",
              "rhs": "invo"
            }
          ]
        },
        "block": [
          {
            "number": 18,
            "provider": "workato_variable",
            "name": "update_variable",
            "as": "60af56a0",
            "title": "Update variable type",
            "description": "Update variable <span class=\"provider\">type</span>",
            "keyword": "action",
            "dynamicPickListSelection": {
              "name": "type (step 2)"
            },
            "toggleCfg": {
            },
            "input": {
              "name": "f9ae23e2-5b7b-4b0e-b0f7-f54cbc5dd938:7a1d0a8b",
              "value": "Invoice"
            },
            "extended_input_schema": [
              {
                "type": "string",
                "name": "value",
                "control_type": "text",
                "label": "Value",
                "hint": "Provide value for the variable",
                "strip_interpolation": true
              }
            ],
            "uuid": "4360b752-3095-4655-97b0-488b3238f88d"
          }
        ],
        "uuid": "26590272-d476-4bb6-8a07-7290b51456f8"
      },
      {
        "number": 19,
        "keyword": "if",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "compound",
          "operand": "and",
          "conditions": [
            {
              "operand": "equals_to",
              "lhs": "#{_('data.workato_variable.aa212a0e.value')}",
              "rhs": "par"
            }
          ]
        },
        "block": [
          {
            "number": 20,
            "provider": "workato_variable",
            "name": "update_variable",
            "as": "bc4fd8c2",
            "title": "Update variable type",
            "description": "Update variable <span class=\"provider\">type</span>",
            "keyword": "action",
            "dynamicPickListSelection": {
              "name": "type (step 2)"
            },
            "toggleCfg": {
            },
            "input": {
              "name": "f9ae23e2-5b7b-4b0e-b0f7-f54cbc5dd938:7a1d0a8b",
              "value": "Partner"
            },
            "extended_input_schema": [
              {
                "type": "string",
                "name": "value",
                "control_type": "text",
                "label": "Value",
                "hint": "Provide value for the variable",
                "strip_interpolation": true
              }
            ],
            "uuid": "a9aee6b8-097f-4ca2-8d46-22b7a531c769"
          }
        ],
        "uuid": "1c2c4f04-ba16-4f00-baa3-b28dd53564bd"
      },
      {
        "number": 21,
        "keyword": "if",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "compound",
          "operand": "and",
          "conditions": [
            {
              "operand": "equals_to",
              "lhs": "#{_('data.workato_variable.aa212a0e.value')}",
              "rhs": "pmt"
            }
          ]
        },
        "block": [
          {
            "number": 22,
            "provider": "workato_variable",
            "name": "update_variable",
            "as": "23fa3a4c",
            "title": "Update variable type",
            "description": "Update variable <span class=\"provider\">type</span>",
            "keyword": "action",
            "dynamicPickListSelection": {
              "name": "type (step 2)"
            },
            "toggleCfg": {
            },
            "input": {
              "name": "f9ae23e2-5b7b-4b0e-b0f7-f54cbc5dd938:7a1d0a8b",
              "value": "Payment"
            },
            "extended_input_schema": [
              {
                "type": "string",
                "name": "value",
                "control_type": "text",
                "label": "Value",
                "hint": "Provide value for the variable",
                "strip_interpolation": true
              }
            ],
            "uuid": "564f14bc-d1a0-4454-9aed-2216b26a1ec4"
          }
        ],
        "uuid": "b0656423-c441-49a4-921f-dc5277db37e6"
      },
      {
        "number": 23,
        "provider": "workato_service",
        "name": "send_reply",
        "as": "bfd624aa",
        "title": null,
        "description": "Return <span class=\"provider\">response</span> from <span class=\"provider\">Convert VersaPay Identifier to NetSuite Internal ID</span>",
        "keyword": "action",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "reply_type": "success",
          "reply": {
            "type": "#{_('data.workato_variable.7a1d0a8b.value')}",
            "netsuite_internal_id": "#{_('data.workato_variable.3a4377cd.value')}"
          }
        },
        "extended_input_schema": [
          {
            "type": "object",
            "name": "reply",
            "label": "Reply",
            "properties": [
              {
                "control_type": "text",
                "label": "NetSuite Internal ID",
                "name": "netsuite_internal_id",
                "type": "string",
                "optional": false,
                "parent": "reply"
              },
              {
                "control_type": "text",
                "label": "Type",
                "name": "type",
                "type": "string",
                "optional": false,
                "parent": "reply"
              }
            ]
          }
        ],
        "uuid": "23629c00-2402-4bcd-a7eb-48a9bfcd98f7"
      }
    ],
    "job_report_schema": [
      {
        "name": "custom_column_1",
        "label": "Type"
      },
      {
        "name": "custom_column_2",
        "label": "Internal ID"
      },
      {
        "name": "custom_column_3",
        "label": "VersaPay Identifier"
      }
    ],
    "job_report_config": {
      "custom_column_1": "#{_('data.workato_variable.7a1d0a8b.value')}",
      "custom_column_2": "#{_('data.workato_variable.3a4377cd.value')}",
      "custom_column_3": "#{_('data.workato_service.f45c6aa0.request.versapay_identifier')}"
    },
    "uuid": "6316ba19-61d6-498e-a2fa-8027d8128b49"
  },
  "config": [
    {
      "keyword": "application",
      "provider": "workato_service",
      "account_id": null
    },
    {
      "keyword": "application",
      "provider": "workato_variable",
      "account_id": null
    }
  ]
}