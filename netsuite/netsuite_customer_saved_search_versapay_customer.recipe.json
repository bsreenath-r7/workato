{
  "name": "NetSuite Customer Saved Search - VersaPay Customer",
  "description": "When there is a trigger event, do action",
  "version": 4,
  "private": true,
  "concurrency": 5,
  "code": {
    "number": 0,
    "provider": "netsuite",
    "name": "updated_saved_search_result",
    "as": "eb08b1ab",
    "title": "New/updated standard records in a saved search",
    "description": "          New or updated search result for\n          <span class=\"provider\">Customer</span>\n          in <span class=\"provider\">NetSuite</span>\n",
    "keyword": "trigger",
    "dynamicPickListSelection": {
      "netsuite_object": "Customer",
      "custom_list": [
        {
          "label": "AR Credit Status",
          "value": "entityCustomField@9977"
        }
      ],
      "netsuite_search_type": "Customer",
      "object_list": [
        {
          "label": "Customer",
          "value": "basic"
        }
      ],
      "join_field_list": [
        {
          "label": "Customer : Internal ID",
          "value": "basic.internalId"
        }
      ]
    },
    "toggleCfg": {
      "saved_search": false
    },
    "input": {
      "custom_list": "entityCustomField@9977",
      "netsuite_search_type": "Customer",
      "saved_search": "37305",
      "object_list": "basic",
      "join_field_list": "basic.internalId"
    },
    "extended_output_schema": [
      {
        "type": "object",
        "name": "basic",
        "label": "Basic",
        "optional": true,
        "properties": [
          {
            "control_type": "text",
            "label": "Internal ID",
            "optional": true,
            "ns_content_type": "element",
            "ns_tag": "platformCommon",
            "ns_search_type": "SearchColumnSelectField",
            "type": "string",
            "name": "internalId"
          },
          {
            "properties": [
              {
                "control_type": "text",
                "label": "AR Credit Status ID",
                "ns_custom_type": "SelectCustomFieldRef",
                "ns_search_type": "SearchSelectCustomField",
                "optional": true,
                "custom": true,
                "sticky": false,
                "toggle_hint": "Enter custom value",
                "toggle_field": {
                  "control_type": "select",
                  "label": "AR Credit Status ID",
                  "toggle_hint": "Select from list",
                  "optional": true,
                  "custom": true,
                  "sticky": false,
                  "type": "string",
                  "name": "f_9977_custentityr7_ar_credit_status",
                  "pick_list": [
                    [
                      "Delinquent",
                      "1"
                    ],
                    [
                      "Credit Hold",
                      "2"
                    ],
                    [
                      "Off",
                      "3"
                    ]
                  ]
                },
                "type": "string",
                "name": "f_9977_custentityr7_ar_credit_status"
              }
            ],
            "label": "Custom fields",
            "optional": true,
            "type": "object",
            "name": "custom_fields"
          }
        ],
        "ns_content_type": "element",
        "ns_tag": "listsRelationships"
      }
    ],
    "extended_input_schema": [
      {
        "type": "string",
        "name": "custom_list",
        "control_type": "multiselect",
        "label": "Customer custom fields",
        "hint": "Select the custom fields to be returned in the output datatree. If no fields are selected, 50 custom fields will be retrieved by default.",
        "sticky": true,
        "pick_list": "custom_body_pick_list",
        "pick_list_params": {
          "netsuite_object": "netsuite_search_type"
        },
        "optional": true,
        "extends_schema": true,
        "delimiter": "\n"
      },
      {
        "type": "string",
        "name": "custom_segment_schema",
        "control_type": "schema-designer",
        "label": "Customer custom segment fields",
        "hint": "Describe schema for Customer 'custom segment' fields",
        "optional": true,
        "extends_schema": true
      }
    ],
    "block": [
      {
        "number": 1,
        "provider": "workato_service",
        "name": "call_service",
        "as": "e3871aad",
        "title": null,
        "description": "Call recipe <span class=\"provider\">Upsert NetSuite Customer to VersaPay Customer</span> ",
        "keyword": "action",
        "dynamicPickListSelection": {
          "flow_id": "Upsert NetSuite Customer to VersaPay Customer"
        },
        "toggleCfg": {
          "request.upsert_only_when_present": true
        },
        "input": {
          "flow_id": {
            "zip_name": "netsuite/callable/callable_upsert_netsuite_customer_to_versapay_customer.recipe.json",
            "name": "Callable - Upsert NetSuite Customer to VersaPay Customer",
            "folder": "netsuite/callable"
          },
          "request": {
            "upsert_only_when_present": "true",
            "ns_customer_internal_id": "#{_('data.netsuite.eb08b1ab.basic.internalId')}"
          }
        },
        "extended_output_schema": [
          {
            "type": "object",
            "name": "reply",
            "label": "Reply",
            "properties": [
              {
                "control_type": "text",
                "label": "VersaPay Customer Identifier",
                "name": "versapay_customer_identifier",
                "type": "string",
                "optional": false,
                "hint": "Contains the ID of the VersaPay Customer that was upserted ('0' if no upsert was completed)"
              }
            ]
          }
        ],
        "extended_input_schema": [
          {
            "type": "object",
            "name": "request",
            "label": "Recipe input",
            "properties": [
              {
                "control_type": "text",
                "label": "NetSuite Customer Internal ID",
                "name": "ns_customer_internal_id",
                "type": "string",
                "optional": false,
                "parent": "request"
              },
              {
                "control_type": "checkbox",
                "label": "Insert Only",
                "render_input": {
                },
                "parse_output": {
                },
                "toggle_hint": "Select from option list",
                "toggle_field": {
                  "label": "Insert Only",
                  "control_type": "text",
                  "toggle_hint": "Use custom value",
                  "name": "insert_only",
                  "type": "boolean",
                  "optional": true,
                  "hint": "If set to 'True', only do an insert (do not update the customer if it already exists).  This is for performance to prevent unnecessary updates.",
                  "parent": "request"
                },
                "name": "insert_only",
                "type": "boolean",
                "optional": true,
                "hint": "If set to 'True', only do an insert (do not update the customer if it already exists).  This is for performance to prevent unnecessary updates.",
                "parent": "request"
              },
              {
                "control_type": "checkbox",
                "label": "Upsert Only When Present",
                "render_input": {
                },
                "parse_output": {
                },
                "toggle_hint": "Select from option list",
                "toggle_field": {
                  "label": "Upsert Only When Present",
                  "control_type": "text",
                  "toggle_hint": "Use custom value",
                  "name": "upsert_only_when_present",
                  "type": "boolean",
                  "optional": true,
                  "hint": "Only perform the upsert if the Customer already exists in VersaPay.",
                  "parent": "request"
                },
                "name": "upsert_only_when_present",
                "type": "boolean",
                "optional": true,
                "hint": "Only perform the upsert if the Customer already exists in VersaPay.",
                "parent": "request"
              },
              {
                "control_type": "checkbox",
                "label": "Is Autorenewal Child?",
                "render_input": {
                },
                "parse_output": {
                },
                "toggle_hint": "Select from option list",
                "toggle_field": {
                  "label": "Is autorenewal child",
                  "control_type": "text",
                  "toggle_hint": "Use custom value",
                  "name": "is_autorenewal_child",
                  "type": "boolean",
                  "optional": true,
                  "hint": "Determines whether to create a child customer for auto-renewals",
                  "parent": "request"
                },
                "name": "is_autorenewal_child",
                "type": "boolean",
                "optional": true,
                "hint": "Determines whether to create a child customer for auto-renewals",
                "parent": "request"
              },
              {
                "control_type": "text",
                "label": "Parent VersaPay Identifier",
                "name": "parent_versapay_identifier",
                "type": "string",
                "optional": true,
                "parent": "request"
              }
            ]
          }
        ],
        "visible_config_fields": [
          "flow_id",
          "request.upsert_only_when_present"
        ],
        "comment": "Update the main customer record in VersaPay",
        "uuid": "dafed33b-a550-4b22-b88f-189c7f0f492a"
      },
      {
        "number": 2,
        "keyword": "if",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "compound",
          "operand": "and",
          "conditions": [
            {
              "operand": "present",
              "lhs": "#{_('data.workato_service.e3871aad.reply.versapay_customer_identifier')}",
              "rhs": null
            }
          ]
        },
        "block": [
          {
            "number": 3,
            "provider": "workato_service",
            "name": "call_service_async",
            "as": "506ef91f",
            "title": null,
            "description": "Call recipe <span class=\"provider\">Upsert NetSuite Customer to VersaPay Customer</span> (do not wait for response)",
            "keyword": "action",
            "dynamicPickListSelection": {
              "flow_id": "Upsert NetSuite Customer to VersaPay Customer"
            },
            "toggleCfg": {
              "request.upsert_only_when_present": true,
              "request.is_autorenewal_child": true
            },
            "input": {
              "flow_id": {
                "zip_name": "netsuite/callable/callable_upsert_netsuite_customer_to_versapay_customer.recipe.json",
                "name": "Callable - Upsert NetSuite Customer to VersaPay Customer",
                "folder": "netsuite/callable"
              },
              "request": {
                "upsert_only_when_present": "true",
                "ns_customer_internal_id": "#{_('data.netsuite.eb08b1ab.basic.internalId')}",
                "is_autorenewal_child": "true",
                "parent_versapay_identifier": "#{_('data.workato_service.e3871aad.reply.versapay_customer_identifier')}"
              }
            },
            "extended_input_schema": [
              {
                "type": "object",
                "name": "request",
                "label": "Recipe input",
                "properties": [
                  {
                    "control_type": "text",
                    "label": "NetSuite Customer Internal ID",
                    "name": "ns_customer_internal_id",
                    "type": "string",
                    "optional": false,
                    "parent": "request"
                  },
                  {
                    "control_type": "checkbox",
                    "label": "Insert Only",
                    "render_input": {
                    },
                    "parse_output": {
                    },
                    "toggle_hint": "Select from option list",
                    "toggle_field": {
                      "label": "Insert Only",
                      "control_type": "text",
                      "toggle_hint": "Use custom value",
                      "name": "insert_only",
                      "type": "boolean",
                      "optional": true,
                      "hint": "If set to 'True', only do an insert (do not update the customer if it already exists).  This is for performance to prevent unnecessary updates.",
                      "parent": "request"
                    },
                    "name": "insert_only",
                    "type": "boolean",
                    "optional": true,
                    "hint": "If set to 'True', only do an insert (do not update the customer if it already exists).  This is for performance to prevent unnecessary updates.",
                    "parent": "request"
                  },
                  {
                    "control_type": "checkbox",
                    "label": "Upsert Only When Present",
                    "render_input": {
                    },
                    "parse_output": {
                    },
                    "toggle_hint": "Select from option list",
                    "toggle_field": {
                      "label": "Upsert Only When Present",
                      "control_type": "text",
                      "toggle_hint": "Use custom value",
                      "name": "upsert_only_when_present",
                      "type": "boolean",
                      "optional": true,
                      "hint": "Only perform the upsert if the Customer already exists in VersaPay.",
                      "parent": "request"
                    },
                    "name": "upsert_only_when_present",
                    "type": "boolean",
                    "optional": true,
                    "hint": "Only perform the upsert if the Customer already exists in VersaPay.",
                    "parent": "request"
                  },
                  {
                    "control_type": "checkbox",
                    "label": "Is Autorenewal Child?",
                    "render_input": {
                    },
                    "parse_output": {
                    },
                    "toggle_hint": "Select from option list",
                    "toggle_field": {
                      "label": "Is autorenewal child",
                      "control_type": "text",
                      "toggle_hint": "Use custom value",
                      "name": "is_autorenewal_child",
                      "type": "boolean",
                      "optional": true,
                      "hint": "Determines whether to create a child customer for auto-renewals",
                      "parent": "request"
                    },
                    "name": "is_autorenewal_child",
                    "type": "boolean",
                    "optional": true,
                    "hint": "Determines whether to create a child customer for auto-renewals",
                    "parent": "request"
                  },
                  {
                    "control_type": "text",
                    "label": "Parent VersaPay Identifier",
                    "name": "parent_versapay_identifier",
                    "type": "string",
                    "optional": true,
                    "parent": "request"
                  }
                ]
              }
            ],
            "comment": "Update the child customer record if it exists",
            "uuid": "a07a0ed7-72f5-4e72-8373-ce5654920a83"
          }
        ],
        "comment": "If the customer exists as a customer in VersaPay, check to see if there is a \"child\" record as well",
        "uuid": "74ba4591-f23a-4d02-a559-726f58ad60b3"
      }
    ],
    "job_report_schema": [
      {
        "name": "custom_column_1",
        "label": "NS Internal ID"
      },
      {
        "name": "custom_column_2",
        "label": "VP Identifier"
      }
    ],
    "job_report_config": {
      "custom_column_1": "#{_('data.netsuite.eb08b1ab.basic.internalId')}",
      "custom_column_2": "#{_('data.workato_service.e3871aad.reply.versapay_customer_identifier')}"
    },
    "uuid": "b5789836-ac3f-48b1-a5f7-e2bc131b68fe"
  },
  "config": [
    {
      "keyword": "application",
      "provider": "netsuite",
      "account_id": {
        "zip_name": "resources/netsuite.connection.json",
        "name": "NetSuite",
        "folder": "resources"
      }
    },
    {
      "keyword": "application",
      "provider": "workato_service",
      "account_id": null
    }
  ]
}