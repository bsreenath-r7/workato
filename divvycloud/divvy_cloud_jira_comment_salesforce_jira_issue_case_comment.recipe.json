{
  "name": "Divvy Cloud Jira Comment - Salesforce Jira Issue/Case Comment",
  "description": "When there is a new event via HTTP webhook, do action",
  "version": 1,
  "private": true,
  "concurrency": 5,
  "code": {
    "number": 0,
    "provider": "workato_webhooks",
    "name": "new_event",
    "as": "8400c4c8",
    "title": null,
    "description": "<span class=\"provider\">New/updated divvy jira comments</span> via <span class=\"provider\">HTTP webhook</span>",
    "keyword": "trigger",
    "dynamicPickListSelection": {
    },
    "toggleCfg": {
    },
    "input": {
      "request": {
        "webhook_type": "json",
        "payload_schema": "[{\"name\":\"webhookEvent\",\"type\":\"string\",\"optional\":false,\"control_type\":\"text\"},{\"name\":\"issue_event_type_name\",\"type\":\"string\",\"optional\":false,\"control_type\":\"text\"},{\"name\":\"issue\",\"type\":\"object\",\"optional\":false,\"properties\":[{\"name\":\"key\",\"type\":\"string\",\"optional\":false,\"control_type\":\"text\"}]},{\"name\":\"comment\",\"type\":\"object\",\"optional\":false,\"properties\":[{\"name\":\"body\",\"type\":\"string\",\"optional\":false,\"control_type\":\"text\"},{\"name\":\"created\",\"type\":\"date_time\",\"optional\":false},{\"name\":\"updated\",\"type\":\"date_time\",\"optional\":false}]}]"
      },
      "webhook_suffix": "New/Updated Divvy Jira Comments"
    },
    "filter": {
      "conditions": [
        {
          "operand": "contains",
          "lhs": "=[\"comment_created\", \"comment_updated\"]",
          "rhs": "#{_('data.workato_webhooks.8400c4c8.payload.webhookEvent')}",
          "uuid": "condition-f83299f3-3581-4136-af0f-75f0824742bc"
        },
        {
          "operand": "present",
          "lhs": "=lookup(\"JIRA_VARIABLES\", key: \"project.\"+_('data.workato_webhooks.8400c4c8.payload.issue.key').split(\"-\")[0])[\"value\"]",
          "rhs": "",
          "uuid": "condition-d585026e-1191-4cbb-b2a6-1a9b0457e4cb"
        }
      ],
      "operand": "and",
      "type": "compound"
    },
    "extended_output_schema": [
      {
        "type": "object",
        "name": "headers",
        "label": "Headers",
        "properties": [

        ]
      },
      {
        "type": "object",
        "name": "payload",
        "label": "Payload",
        "properties": [
          {
            "control_type": "text",
            "label": "Webhook event",
            "name": "webhookEvent",
            "type": "string",
            "optional": false
          },
          {
            "control_type": "text",
            "label": "Issue event type name",
            "name": "issue_event_type_name",
            "type": "string",
            "optional": false
          },
          {
            "properties": [
              {
                "control_type": "text",
                "label": "Key",
                "name": "key",
                "type": "string",
                "optional": false
              }
            ],
            "label": "Issue",
            "name": "issue",
            "type": "object",
            "optional": false
          },
          {
            "properties": [
              {
                "control_type": "text",
                "label": "Body",
                "name": "body",
                "type": "string",
                "optional": false
              },
              {
                "control_type": "date_time",
                "label": "Created",
                "render_input": "date_time_conversion",
                "parse_output": "date_time_conversion",
                "name": "created",
                "type": "date_time",
                "optional": false
              },
              {
                "control_type": "date_time",
                "label": "Updated",
                "render_input": "date_time_conversion",
                "parse_output": "date_time_conversion",
                "name": "updated",
                "type": "date_time",
                "optional": false
              }
            ],
            "label": "Comment",
            "name": "comment",
            "type": "object",
            "optional": false
          }
        ]
      }
    ],
    "extended_input_schema": [
      {
        "type": "object",
        "name": "request",
        "label": "Payload configuration",
        "properties": [
          {
            "control_type": "select",
            "label": "Webhook type",
            "pick_list": [
              [
                "GET request",
                "get"
              ],
              [
                "PUT/POST with JSON payload",
                "json"
              ],
              [
                "PUT/POST with XML payload",
                "xml"
              ],
              [
                "PUT/POST with FORM encoded payload",
                "form"
              ],
              [
                "PUT/POST with raw binary data",
                "rawdata"
              ],
              [
                "PUT/POST with unicode text data",
                "rawdatatxt"
              ]
            ],
            "hint": "Select the HTTP method and payload data type used by webhook. <a href=\"https://support.workato.com/support/solutions/articles/1000241356-http-real-time-webhook-type\" target=\"_blank\">Learn more</a>",
            "default": "json",
            "extends_schema": true,
            "type": "string",
            "name": "webhook_type"
          },
          {
            "control_type": "schema-designer",
            "label": "Payload schema",
            "sample_data_type": "json_http",
            "extends_schema": true,
            "empty_schema_title": "Describe all fields in your response.",
            "optional": true,
            "sticky": true,
            "type": "string",
            "name": "payload_schema"
          },
          {
            "control_type": "schema-designer",
            "label": "Headers",
            "extends_schema": true,
            "empty_schema_title": "Describe all the webhook headers",
            "optional": true,
            "sticky": true,
            "type": "string",
            "name": "headers_schema"
          }
        ],
        "override": true
      }
    ],
    "block": [
      {
        "number": 1,
        "keyword": "if",
        "dynamicPickListSelection": {
        },
        "toggleCfg": {
        },
        "input": {
          "type": "compound",
          "operand": "and",
          "conditions": [
            {
              "operand": "present",
              "lhs": "#{_('data.workato_webhooks.8400c4c8.payload.comment.body')}",
              "rhs": "",
              "uuid": "condition-8be9106a-911e-4e82-a519-6d676cf21385"
            }
          ]
        },
        "block": [
          {
            "number": 2,
            "provider": "workato_service",
            "name": "call_service",
            "as": "357f075d",
            "title": null,
            "description": "Call recipe <span class=\"provider\">Add Salesforce Case Comment for Cases Related to Divvy Cloud Jira</span> ",
            "keyword": "action",
            "dynamicPickListSelection": {
              "flow_id": "Add Salesforce Case Comment for Cases Related to Divvy Cloud Jira"
            },
            "toggleCfg": {
            },
            "input": {
              "flow_id": {
                "zip_name": "divvycloud/callable/callable_add_salesforce_case_comment_for_cases_related_to_divvy_cloud_jira.recipe.json",
                "name": "Callable -Â Add Salesforce Case Comment for Cases Related to Divvy Cloud Jira",
                "folder": "divvycloud/callable"
              },
              "request": {
                "jira_key": "#{_('data.workato_webhooks.8400c4c8.payload.issue.key')}",
                "comment": "=_('data.workato_webhooks.8400c4c8.payload.issue.key')+\" has \"+ (_('data.workato_webhooks.8400c4c8.payload.webhookEvent').match?(/comment_created/) ? \"a new \" : \"an edited \") +\" comment, click https://divvycloud.atlassian.net/browse/\"+_('data.workato_webhooks.8400c4c8.payload.issue.key')+\" to view the ticket.\nComment below:\n\"+_('data.workato_webhooks.8400c4c8.payload.comment.body')"
              }
            },
            "extended_output_schema": [
              {
                "type": "object",
                "name": "reply",
                "label": "Reply",
                "properties": [
                  {
                    "name": "cases_updated",
                    "type": "array",
                    "of": "object",
                    "label": "Cases updated",
                    "optional": true,
                    "properties": [
                      {
                        "control_type": "text",
                        "label": "Case ID",
                        "name": "case_id",
                        "type": "string",
                        "optional": false
                      },
                      {
                        "control_type": "text",
                        "label": "Case number",
                        "name": "case_number",
                        "type": "string",
                        "optional": false
                      }
                    ]
                  }
                ]
              }
            ],
            "extended_input_schema": [
              {
                "type": "object",
                "name": "request",
                "label": "Recipe input",
                "properties": [
                  {
                    "control_type": "text",
                    "label": "Jira key",
                    "name": "jira_key",
                    "type": "string",
                    "optional": false
                  },
                  {
                    "control_type": "text",
                    "label": "Comment",
                    "name": "comment",
                    "type": "string",
                    "optional": false
                  }
                ]
              }
            ],
            "uuid": "380ff1fa-65fc-4dcf-aad1-6fb98c18a59d"
          }
        ],
        "comment": "Make sure the comment has a body.",
        "uuid": "1ae3a689-80b5-4845-a218-3694b9e108c4"
      }
    ],
    "comment": "Realtime event update for comment via jira webhook",
    "job_report_schema": [
      {
        "name": "custom_column_1",
        "label": "Jira Key"
      },
      {
        "name": "custom_column_2",
        "label": "Webhook Event"
      },
      {
        "name": "custom_column_3",
        "label": "Comment Add To Case(s)"
      },
      {
        "name": "custom_column_4",
        "label": "Comment"
      }
    ],
    "job_report_config": {
      "custom_column_1": "#{_('data.workato_webhooks.8400c4c8.payload.issue.key')}",
      "custom_column_2": "#{_('data.workato_webhooks.8400c4c8.payload.webhookEvent')}",
      "custom_column_3": "=_('data.workato_service.357f075d.reply.cases_updated').pluck(\"case_number\").join(\", \")",
      "custom_column_4": "#{_('data.workato_webhooks.8400c4c8.payload.comment.body')}"
    },
    "uuid": "c7a21785-a422-458b-a525-ec86eb2e5b6e",
    "wizardFinished": true
  },
  "config": [
    {
      "keyword": "application",
      "provider": "workato_webhooks",
      "skip_validation": false,
      "account_id": null
    },
    {
      "keyword": "application",
      "provider": "workato_service",
      "skip_validation": false,
      "account_id": null
    }
  ]
}